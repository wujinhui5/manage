"use strict";(self["webpackChunkmanagement"]=self["webpackChunkmanagement"]||[]).push([[986],{7986:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"shop-pic-upload"},[e("div",{staticClass:"main"},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"#",multiple:"",accept:".jpg,.png","on-change":t.onChange,"on-exceed":t.handExceed,"auto-upload":!1,"list-type":"picture",limit:5}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件，且不超过500kb ")])])],1),e("div",{staticClass:"button"},[e("div",{staticClass:"next"},[e("el-button",{on:{click:t.handlePrev}},[t._v("上一步，填写商品基本信息")])],1),e("div",{staticClass:"create"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleAddShop}},[t._v("创建商品")])],1)])])},n=[],i=s(6124),r={props:{form:Object},data(){return{files:[]}},methods:{onChange(t){const e=t.name.substring(t.name.indexOf(".")+1);if("jpg"!==e&&"png"!==e)this.$message.error("只能上传jpg/png文件"),this.$refs.upload.uploadFiles.pop();else if(parseInt(t.size)>5e5)this.$message.error("只能上传不超过500kb的文件"),this.$refs.upload.uploadFiles.pop();else{let e=new FileReader;e.readAsDataURL(t.raw),e.onload=t=>{this.files.push(t.target.result)}}},handlePrev(){this.$emit("prevStep")},handExceed(t,e){this.$message.warning(`当前限制选择 5 个文件，本次选择了 ${t.length} 个文件，共选择了 ${t.length+e.length} 个文件`)},handleAddShop(){if(0===this.files.length)return void this.$message.error("请至少上传一张商品图片");let t=JSON.stringify({uid:this.$store.state.user.uid,newShop:{...this.form,shopPic:this.files}});(0,i.Od)(t).then((t=>{let e=JSON.parse(t.data);200===e.meta.status?this.$router.push("/shop/addCompleted"):this.$message.error(e.meta.msg)})).catch((t=>this.$message.error(t)))}}},o=r,l=s(1001),d=(0,l.Z)(o,a,n,!1,null,"c1a8fd2a",null),u=d.exports},6124:function(t,e,s){s.d(e,{Fk:function(){return r},Od:function(){return o},c_:function(){return i},jo:function(){return n}});var a=s(4003);function n(t){return(0,a.Z)({method:"post",url:"/shop/delete",data:t})}function i(t){return(0,a.Z)({method:"post",url:"/get/shops",data:t})}function r(t){return(0,a.Z)({method:"post",url:"/shop/change",data:t})}function o(t){return(0,a.Z)({method:"post",url:"/shop/create",data:t})}}}]);
//# sourceMappingURL=986.8802c9c8.js.map