"use strict";(self["webpackChunkmanagement"]=self["webpackChunkmanagement"]||[]).push([[760],{9103:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[t("div",{staticClass:"title"},[t("i",{staticClass:"el-icon-search"}),t("span",[e._v("筛选搜索")]),t("el-button",{staticClass:"fr",attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{staticClass:"btn-reset fr",attrs:{size:"small"},on:{click:e.handleReset}},[e._v(" 重置 ")])],1),e._t("default")],2)},r=[],n={methods:{handleSearch(){this.$emit("handleSearch")},handleReset(){this.$emit("handleReset")}}},l=n,o=a(1001),i=(0,o.Z)(l,s,r,!1,null,"40da735d",null),c=i.exports},114:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[t("i",{staticClass:"el-icon-tickets"}),t("span",[e._v("数据列表")]),e._t("default")],2)},r=[],n={},l=n,o=a(1001),i=(0,o.Z)(l,s,r,!1,null,"3cadd859",null),c=i.exports},9760:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"all-customer"},[t("search",{on:{handleReset:e.handleResetSearch,handleSearch:e.handleSearch}},[t("el-input",{staticClass:"search",attrs:{placeholder:"请输入用户名或地址",clearable:""},model:{value:e.queryList.key,callback:function(t){e.$set(e.queryList,"key",t)},expression:"queryList.key"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("add"),t("el-table",{attrs:{data:e.users,"row-class-name":e.isBanned,border:""}},[t("el-table-column",{attrs:{label:"出生日期",prop:"date"}}),t("el-table-column",{attrs:{label:"姓名",prop:"name"}}),t("el-table-column",{attrs:{label:"地址",prop:"address"}}),t("el-table-column",{attrs:{label:"操作",width:"199"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.status?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleChangeStatus(a.row.uid)}}},[e._v("封禁")]):e._e(),a.row.status?e._e():t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.handleChangeStatus(a.row.uid)}}},[e._v("解封")]),t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.handleChangeCustomer(a.row)}}},[e._v("编辑")]),t("el-button",{staticStyle:{margin:"5px 0 0"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDeleteCustomer(a.row.uid)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:"修改用户信息",visible:e.changeInfoDialogVisible},on:{"update:visible":function(t){e.changeInfoDialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.changeInfoDialogForm,rules:e.changeInfoDialogFormRules,"status-icon":""}},[t("el-form-item",{attrs:{label:"姓名","label-width":"120px",prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.changeInfoDialogForm.name,callback:function(t){e.$set(e.changeInfoDialogForm,"name",t)},expression:"changeInfoDialogForm.name"}})],1),t("el-form-item",{attrs:{label:"地址","label-width":"120px",prop:"address"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.changeInfoDialogForm.address,callback:function(t){e.$set(e.changeInfoDialogForm,"address",t)},expression:"changeInfoDialogForm.address"}})],1),t("el-form-item",{attrs:{label:"活动时间","label-width":"120px"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.changeInfoDialogForm.date,callback:function(t){e.$set(e.changeInfoDialogForm,"date",t)},expression:"changeInfoDialogForm.date"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.changeInfoDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateChangeCustomer}},[e._v("确 定")])],1)],1),t("el-pagination",{attrs:{"current-page":e.queryList.currentPage,"page-size":e.queryList.pageSize,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.changePage,"update:currentPage":function(t){return e.$set(e.queryList,"currentPage",t)},"update:current-page":function(t){return e.$set(e.queryList,"currentPage",t)}}})],1)},r=[],n=a(114),l=a(9103),o=a(4003);function i(e){return(0,o.Z)({method:"post",url:"/get/customers",data:e})}function c(e){return(0,o.Z)({method:"post",url:"/customer/delete",data:e})}function u(e){return(0,o.Z)({method:"post",url:"/customer/change",data:e})}function h(e){return(0,o.Z)({method:"post",url:"/customer/status/change",data:e})}const m={currentPage:1,pageSize:5,key:""};var d={components:{Add:n.Z,Search:l.Z},data(){return{users:[],total:0,queryList:{...m},changeInfoDialogVisible:!1,changeInfoDialogForm:{},changeInfoDialogFormRules:{name:[{required:!0,message:"用户名不能为空",trigger:"blur"}],address:[{required:!0,message:"地址不能为空",trigger:"blur"}]}}},created(){this.getAllCustomer()},methods:{getAllCustomer(){i(this.queryList).then((e=>{let t=JSON.parse(e.data);if(200===t.meta.status){let{total:e,list:a}=t.data;this.users=a,this.total=e}else this.$message.error(t.meta.msg)})).catch((e=>{this.$message.error(e)}))},changePage(e){this.queryList.currentPage=e,this.getAllCustomer()},handleSearch(){this.queryList.currentPage=1,this.getAllCustomer()},handleResetSearch(){this.queryList={...m}},isBanned(e){return e.row.status?"":"banned"},handleChangeStatus(e){h(e).then((e=>{let t=JSON.parse(e.data);200===t.meta.status?(this.$message.success(t.meta.msg),this.getAllCustomer()):this.$message.error(t.meta.msg)})).catch((e=>{this.$message.error(e)}))},handleChangeCustomer(e){this.changeInfoDialogForm={...e},this.changeInfoDialogVisible=!0},updateChangeCustomer(){this.$refs.form.validate((e=>{if(!e)return;let{changeInfoDialogForm:t,$message:a,getAllCustomer:s}=this;t.date=this.formatDate(t.date),u(t).then((e=>{let t=JSON.parse(e.data);200===t.meta.status?(a.success(t.meta.msg),s()):a.error(t.meta.msg)})).catch((e=>a.error(e))),this.changeInfoDialogVisible=!1}))},formatDate(e){let t=e;return"string"!=typeof e&&(t=[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-")),t},handleDeleteCustomer(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.updateDeleteCustomer(e)})).catch((()=>{}))},updateDeleteCustomer(e){c(e).then((e=>{let t=JSON.parse(e.data);200===t.meta.status?(this.$message.success(t.meta.msg),this.getAllCustomer()):this.$message.error(t.meta.msg)})).catch((e=>this.$message.error(e)))}}},g=d,f=a(1001),p=(0,f.Z)(g,s,r,!1,null,"dd58df42",null),b=p.exports}}]);
//# sourceMappingURL=760.68e7272a.js.map