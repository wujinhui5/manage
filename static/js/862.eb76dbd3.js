"use strict";(self["webpackChunkmanagement"]=self["webpackChunkmanagement"]||[]).push([[862],{862:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"personal-center"},[t("div",{staticClass:"table"},[t("HeadPortrait",{on:{updata:e.updata}}),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"show-header":!1}},[t("el-table-column",{attrs:{prop:"type",width:"100"}}),t("el-table-column",{attrs:{prop:"value"}}),t("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("ChangeUname",{attrs:{user:a.row},on:{updata:e.updata}})]}}])})],1)],1)])},i=[],r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"head-portrait"},[t("div",{staticClass:"pic"},[t("img",{ref:"img",attrs:{src:this.$store.state.user.headPortrait,alt:"头像"}})]),t("el-button",{staticClass:"open-dialog",attrs:{size:"mini",type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("修改")]),t("el-dialog",{attrs:{title:"修改管理员信息",visible:e.dialogFormVisible,"before-close":e.cancelChange},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("input",{ref:"file",attrs:{type:"file"},on:{change:e.showImgToView}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelChange}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.completeChange}},[e._v("确 定")])],1)])],1)},l=[],o=a(7991),n={data(){return{dialogFormVisible:!1,imgFile:[]}},methods:{showImgToView(){/(PNG|png|jpg|JPG)/.test(this.$refs.file.files[0].name)?this.imgFile=this.$refs.file.files[0]:(this.$message.error("只能上传png或jpg格式的文件"),this.imgFile={})},cancelChange(){this.dialogFormVisible=!1},completeChange(){if(this.dialogFormVisible=!1,!this.imgFile)return void this.$message.error("只能上传png或jpg格式的文件");let e=new FileReader;console.log(this.imgFile,JSON.stringify([this.imgFile])),e.readAsDataURL(this.imgFile),e.onload=e=>{let t={uid:this.$store.state.user.uid,headPortrait:e.target.result};(0,o.L_)(t).then((e=>{let t=JSON.parse(e.data);200===t.meta.status?(this.$message.success(t.meta.msg),this.$emit("updata")):this.$message.error(t.meta.msg)})).catch((e=>{this.$message.error(e)}))}}}},m=n,u=a(1001),c=(0,u.Z)(m,r,l,!1,null,"f72251ac",null),h=c.exports,d=function(){var e=this,t=e._self._c;return e.user.alterable?t("div",{staticClass:"change-user-name"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.changeUserName}},[e._v("修改")]),t("el-dialog",{attrs:{title:"修改管理员信息",visible:e.dialogFormVisible,"before-close":e.cancelChange},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"用户名","label-width":"120px"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelChange}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.completeChange}},[e._v("确 定")])],1)],1)],1):e._e()},g=[],p={props:["user"],data(){return{form:{name:this.$store.state.user.name},dialogFormVisible:!1}},methods:{changeUserName(){this.form.name=this.$store.state.user.name,this.dialogFormVisible=!0},cancelChange(){this.dialogFormVisible=!1},completeChange(){let e={uid:this.$store.state.user.uid,name:this.form.name};(0,o.mH)(e).then((e=>{let t=JSON.parse(e.data);200===t.meta.status?(this.$message.success(t.meta.msg),this.$emit("updata")):this.$message.error(t.meta.msg)})).catch((e=>{this.$message.error(e)})),this.dialogFormVisible=!1}}},f=p,b=(0,u.Z)(f,d,g,!1,null,"120ae656",null),v=b.exports,C={components:{ChangeUname:v,HeadPortrait:h},data(){return{breadcrumb:[{name:"个人中心"}]}},methods:{updata(){this.$store.dispatch("user/getInfo")}},computed:{tableData(){return[{type:"name",value:this.$store.state.user.name,alterable:!0},{type:"uid",value:this.$store.state.user.uid},{type:"role",value:this.$store.state.user.role}]}}},$=C,F=(0,u.Z)($,s,i,!1,null,"639dd05e",null),y=F.exports}}]);
//# sourceMappingURL=862.eb76dbd3.js.map